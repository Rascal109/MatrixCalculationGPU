# MatrixCalculationGPU
## 注意
* Vulkanがいじりたくて、かつ普段使っているGPU内蔵CPUのノートPCで並列演算がしてみたくて作ってみたものである。
* Vulkanの設定が必要。
* ワークグループのサイズや共有メモリの大きさなど、PC依存の要素がややあるので、その都度パラメータをいじる必要があるかも？
* `matCalculation.cpp`における`shaderModule`の作成で、`.spv`ファイルのパスを入れているが、初期状態はsrcフォルダの中としている。Visual Studio2022においては、
slnファイルに対してどこにあるかというパスを通せばよいみたい。
* シェーダの変更がしたかったら、`.comp`となっているファイルを書き換えたのち、`glslc`などのツールでSPIR-Vの中間コード(`.spv`ファイル)を作成すればよい。
## 説明
* C++において、Vulkanを用いて行列の和積をおこなうコード。`std::vector<std::vector<float>>`のような`float`型の動的二次元配列を想定している。
返り値の型も`std::vector<std::vector<float>>`である。
* 行列の和と差に関しては、各スレッドごとに足している。
* 行列積に関しては、ローカルグループごとの共有メモリを用いている。。
## 使い方
1. `.spv`ファイルと`matCalculation.cpp`と`matCalculation.h`を適切なフォルダにいれる。
`matCalculation.cpp`における`.spv`ファイルのパスをいじることになる可能性あり。
2.   `Matrix`クラスのインスタンスをつくる。
3. そのインスタンスが持つ関数の引数に、計算したい二次元配列や定数を入れる。
   1.  `multi`関数: 引数に入れた2つの行列の行列積を計算。
   2.  `multiEach`関数: 引数に入れた2つの行列の要素ごとの積を計算。
   3.  `sum`関数: 引数に入れた2つの変数の和を計算。行列同士か、行列と定数の組み合わせがとれる。
   4.  `diff`関数: 引数に入れた2つの変数の差を計算。`(1つ目の引数の行列) - (2つ目の行列の引数)`の順。

